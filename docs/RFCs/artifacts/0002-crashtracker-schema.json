{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "StructuredCrashInfo",
  "type": "object",
  "required": [
    "error",
    "incomplete",
    "os_info",
    "uuid",
    "version_id"
  ],
  "properties": {
    "counters": {
      "type": "object",
      "additionalProperties": {
        "type": "integer",
        "format": "int64"
      }
    },
    "error": {
      "$ref": "#/definitions/ErrorData"
    },
    "files": {
      "type": "object",
      "additionalProperties": {
        "type": "array",
        "items": {
          "type": "string"
        }
      }
    },
    "incomplete": {
      "type": "boolean"
    },
    "metadata": {
      "anyOf": [
        {
          "$ref": "#/definitions/Metadata"
        },
        {
          "type": "null"
        }
      ]
    },
    "os_info": {
      "$ref": "#/definitions/OsInfo"
    },
    "proc_info": {
      "anyOf": [
        {
          "$ref": "#/definitions/ProcessInfo"
        },
        {
          "type": "null"
        }
      ]
    },
    "span_ids": {
      "type": "array",
      "items": {
        "type": "string"
      }
    },
    "timestamp": {
      "type": [
        "string",
        "null"
      ]
    },
    "trace_ids": {
      "type": "array",
      "items": {
        "type": "string"
      }
    },
    "uuid": {
      "type": "string"
    },
    "version_id": {
      "type": "integer",
      "format": "uint64",
      "minimum": 0.0
    }
  },
  "definitions": {
    "ErrorData": {
      "type": "object",
      "required": [
        "is_crash",
        "kind",
        "message",
        "stack",
        "stack_type"
      ],
      "properties": {
        "is_crash": {
          "type": "boolean"
        },
        "kind": {
          "$ref": "#/definitions/ErrorKind"
        },
        "message": {
          "type": "string"
        },
        "stack": {
          "$ref": "#/definitions/StackTrace"
        },
        "stack_type": {
          "$ref": "#/definitions/StackType"
        },
        "threads": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/Thread"
          }
        }
      }
    },
    "ErrorKind": {
      "type": "string",
      "enum": [
        "SigBus",
        "SigSegv",
        "Unknown"
      ]
    },
    "Metadata": {
      "type": "object",
      "required": [
        "family",
        "library_name",
        "library_version",
        "tags"
      ],
      "properties": {
        "family": {
          "type": "string"
        },
        "library_name": {
          "type": "string"
        },
        "library_version": {
          "type": "string"
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "NormalizedAddress": {
      "type": "object",
      "required": [
        "file_offset",
        "meta"
      ],
      "properties": {
        "file_offset": {
          "type": "integer",
          "format": "uint64",
          "minimum": 0.0
        },
        "meta": {
          "$ref": "#/definitions/NormalizedAddressMeta"
        }
      }
    },
    "NormalizedAddressMeta": {
      "oneOf": [
        {
          "type": "string",
          "enum": [
            "Unknown"
          ]
        },
        {
          "type": "object",
          "required": [
            "Apk"
          ],
          "properties": {
            "Apk": {
              "type": "string"
            }
          },
          "additionalProperties": false
        },
        {
          "type": "object",
          "required": [
            "Elf"
          ],
          "properties": {
            "Elf": {
              "type": "object",
              "required": [
                "path"
              ],
              "properties": {
                "build_id": {
                  "type": [
                    "array",
                    "null"
                  ],
                  "items": {
                    "type": "integer",
                    "format": "uint8",
                    "minimum": 0.0
                  }
                },
                "path": {
                  "type": "string"
                }
              }
            }
          },
          "additionalProperties": false
        },
        {
          "type": "object",
          "required": [
            "Unexpected"
          ],
          "properties": {
            "Unexpected": {
              "type": "string"
            }
          },
          "additionalProperties": false
        }
      ]
    },
    "OsInfo": {
      "type": "object",
      "properties": {
        "architecture": {
          "type": "string"
        },
        "bitness": {
          "type": "string"
        },
        "os_type": {
          "type": "string"
        },
        "version": {
          "$ref": "#/definitions/Version"
        }
      }
    },
    "ProcessInfo": {
      "type": "object",
      "required": [
        "pid"
      ],
      "properties": {
        "pid": {
          "type": "integer",
          "format": "uint32",
          "minimum": 0.0
        }
      }
    },
    "StackFrame": {
      "description": "All fields are hex encoded integers.",
      "type": "object",
      "properties": {
        "column": {
          "type": [
            "integer",
            "null"
          ],
          "format": "uint32",
          "minimum": 0.0
        },
        "file": {
          "type": [
            "string",
            "null"
          ]
        },
        "function": {
          "type": [
            "string",
            "null"
          ]
        },
        "ip": {
          "type": [
            "string",
            "null"
          ]
        },
        "line": {
          "type": [
            "integer",
            "null"
          ],
          "format": "uint32",
          "minimum": 0.0
        },
        "module_base_address": {
          "type": [
            "string",
            "null"
          ]
        },
        "normalized_ip": {
          "anyOf": [
            {
              "$ref": "#/definitions/NormalizedAddress"
            },
            {
              "type": "null"
            }
          ]
        },
        "sp": {
          "type": [
            "string",
            "null"
          ]
        },
        "symbol_address": {
          "type": [
            "string",
            "null"
          ]
        }
      }
    },
    "StackTrace": {
      "type": "object",
      "required": [
        "format",
        "trace"
      ],
      "properties": {
        "format": {
          "$ref": "#/definitions/StackType"
        },
        "trace": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/StackFrame"
          }
        }
      }
    },
    "StackType": {
      "type": "string",
      "enum": [
        "CrashTrackerV1"
      ]
    },
    "Thread": {
      "type": "object",
      "required": [
        "crashed",
        "name",
        "stack"
      ],
      "properties": {
        "crashed": {
          "type": "boolean"
        },
        "name": {
          "type": "string"
        },
        "stack": {
          "$ref": "#/definitions/StackTrace"
        },
        "state": {
          "description": "\"Platform-specific state of the thread when its state was captured (CPU registers dump for iOS, thread state enum for Android, etc.).\"",
          "type": "string"
        }
      }
    },
    "Version": {
      "oneOf": [
        {
          "type": "string",
          "enum": [
            "Unknown"
          ]
        },
        {
          "type": "object",
          "required": [
            "Semantic"
          ],
          "properties": {
            "Semantic": {
              "type": "array",
              "items": [
                {
                  "type": "integer",
                  "format": "uint64",
                  "minimum": 0.0
                },
                {
                  "type": "integer",
                  "format": "uint64",
                  "minimum": 0.0
                },
                {
                  "type": "integer",
                  "format": "uint64",
                  "minimum": 0.0
                }
              ],
              "maxItems": 3,
              "minItems": 3
            }
          },
          "additionalProperties": false
        },
        {
          "type": "object",
          "required": [
            "Rolling"
          ],
          "properties": {
            "Rolling": {
              "type": [
                "string",
                "null"
              ]
            }
          },
          "additionalProperties": false
        },
        {
          "type": "object",
          "required": [
            "Custom"
          ],
          "properties": {
            "Custom": {
              "type": "string"
            }
          },
          "additionalProperties": false
        }
      ]
    }
  }
}
